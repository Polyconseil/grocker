FROM {{ root_image_tag }}
LABEL grocker.image.kind=runner

# Provisioning
COPY . /tmp/grocker
# always sync before running script to avoid "unable to execute /tmp/grocker/provision.sh: Text file busy"
RUN sync; /tmp/grocker/provision.sh

# Ports and Volumes
{% if expose %}EXPOSE {% for port in expose %}{{ port }} {% endfor %}{% endif %}
{% if volumes %}VOLUME {{volumes}}{% endif %}

#Â Make the entry point run the compile script
USER grocker
WORKDIR /home/grocker
ENTRYPOINT ["/home/grocker/app.venv/bin/{{ entrypoint_name }}"]
